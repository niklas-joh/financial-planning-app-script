{"chunk":13,"numChunks":27,"fileHash":"Hvfxbs62+mBjdPYhoaFqbZMl0X/76Hadv8OqiZ+yaKg=","filePath":"cline/clasp-verify/src/services/dropdowns.js","content":"/**\nFinancialPlanner.DropdownService = (function(utils, uiService, errorService, config) {\n  function handleTypeEdit(sheet, row, typeToCategories) {\n    const typeCell = sheet.getRange(row, DROPDOWN_CONFIG.COLUMNS.TYPE);\n    const categoryCell = sheet.getRange(row, DROPDOWN_CONFIG.COLUMNS.CATEGORY);\n    const subCategoryCell = sheet.getRange(row, DROPDOWN_CONFIG.COLUMNS.SUB_CATEGORY);\n\n    const type = typeCell.getValue();\n    const oldCategoryValue = categoryCell.getValue();\n    const categories = typeToCategories[type] || [];\n\n    setDropdownValidation(categoryCell, categories);\n\n    if (oldCategoryValue && (categories.length === 0 || !categories.includes(oldCategoryValue))) {\n      categoryCell.clearContent();\n      subCategoryCell.clearContent().clearDataValidations();\n      highlightPending(categoryCell);\n    } else if (categories.length > 0 && !oldCategoryValue) {\n        highlightPending(categoryCell); // Highlight if new options available and cell is empty\n    }\n\n\n    clearPlaceholderIfNeeded(typeCell);\n    if (categoryCell.getValue() !== DROPDOWN_CONFIG.UI.PLACEHOLDER_TEXT && categoryCell.getValue() !== \"\") {\n        clearHighlight(categoryCell);\n    }\n  }\n  /**\n   * Handles edits made to the 'Category' column in the Transactions sheet.\n   * Updates the 'Sub-Category' dropdown based on the selected 'Type' and 'Category'.\n   * @param {GoogleAppsScript.Spreadsheet.Sheet} sheet - The Transactions sheet object.\n   * @param {number} row - The 1-based row number that was edited.\n   * @param {object} typeCategoryToSubCategories - The mapping of (Type+Category) composite keys to their sub-categories.\n   * @return {void}\n   * @private\n   */"}