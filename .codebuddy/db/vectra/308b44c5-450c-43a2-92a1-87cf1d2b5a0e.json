{"chunk":11,"numChunks":20,"fileHash":"o9TH+WxWjuhYMssoSmFWfKxIkklvisnvxWTURfiVSIQ=","filePath":"src/features/reports/monthly_spending_report.js","content":"/**\nFinancialPlanner.MonthlySpendingReport = (function(utils, uiService, errorService, config) {\n  function createMonthlySpendingReport() {\n    const ss = SpreadsheetApp.getActiveSpreadsheet();\n    // Get or create the Monthly Report sheet\n    const reportSheet = utils.getOrCreateSheet(ss, \"Monthly Report\");\n    // Get current month and year\n    const now = new Date();\n    const currentMonth = now.getMonth();\n    const currentYear = now.getFullYear();\n    // Set title\n    reportSheet.getRange(\"A1\").setValue(`Monthly Spending Report - ${utils.getMonthName(currentMonth)} ${currentYear}`);\n    reportSheet.getRange(\"A1:F1\").merge().setFontWeight(\"bold\").setFontSize(14);\n    // Headers\n    reportSheet.getRange(\"A3\").setValue(\"Category\");\n    reportSheet.getRange(\"B3\").setValue(\"Sub-Category\");\n    reportSheet.getRange(\"C3\").setValue(\"Amount\");\n    reportSheet.getRange(\"D3\").setValue(\"% of Total\");\n    reportSheet.getRange(\"E3\").setValue(\"Avg Last 3 Months\");\n    reportSheet.getRange(\"F3\").setValue(\"Trend\");\n    reportSheet.getRange(\"A3:F3\").setFontWeight(\"bold\").setBackground(\"#D9EAD3\");\n    // Get transaction data\n    const transactionSheet = ss.getSheetByName(config.getSheetNames().TRANSACTIONS);\n    if (!transactionSheet) {\n      throw errorService.create(\"Could not find 'Transactions' sheet\", { severity: \"high\" });\n    }\n    const transactionData = transactionSheet.getDataRange().getValues();\n    const headers = transactionData[0];\n    // Find column indices\n    const dateColIndex = headers.indexOf(\"Date\");\n    const typeColIndex = headers.indexOf(\"Type\");\n    const categoryColIndex = headers.indexOf(\"Category\");\n    const subcategoryColIndex = headers.indexOf(\"Sub-Category\");\n    const amountColIndex"}