{"chunk":50,"numChunks":53,"fileHash":"sZNtFtlzBgOlJ3052pxcb3tYBWiJBgfxmxjkXMyDhtg=","filePath":"cline/clasp-verify/src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) { // Added settingsService and analysisServiceInstance\n  return {\n    create: function() {\n      try {\n        uiService.showLoadingSpinner(\"Generating financial overview...\");\n        cacheService.invalidateAll(); // Clear cache to ensure fresh data\n        \n        // Use the builder pattern for a cleaner implementation\n        const builder = new FinancialOverviewBuilder();\n        \n        const result = builder\n          .initialize()\n          .processData()\n          .setupHeader()\n          .generateContent()\n          .addNetCalculations()\n          .addMetrics()\n          .formatSheet()\n          .applyPreferences()\n          .build();\n        \n        uiService.hideLoadingSpinner();\n        uiService.showSuccessNotification(\"Financial overview generated successfully!\");\n        \n        return result;\n      } catch (error) {\n        uiService.hideLoadingSpinner();\n        \n        // Process the error\n        if (error.name === 'FinancialPlannerError') {\n          errorService.log(error);\n          uiService.showErrorNotification(\"Error generating overview\", error.message);\n        } else {\n          // Convert to our custom error format and log\n          const wrappedError = errorService.create(\n            \"Failed to generate financial overview\", \n            { originalError: error.message, stack: error.stack, severity: \"high\" }\n          );\n          errorService.log(wrappedError);\n          uiService.showErrorNotification(\"Error generating overview\", error.message);\n        }\n        \n        throw error;\n      }\n    },"}