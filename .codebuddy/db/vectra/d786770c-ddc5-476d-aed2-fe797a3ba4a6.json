{"chunk":52,"numChunks":54,"fileHash":"vN+W2tDiA59Daq+vJZZ4NvNU8baK6mDpzqFA2kTr3NY=","filePath":"cline/clasp-verify/src/services/financial_analysis.js","content":"/**\nFinancialPlanner.FinancialAnalysisService = (function(utils, uiService, errorService, config) {\n  return {\n    /**\n     * Public method to trigger the generation and display of the key metrics analysis.\n     * It ensures the overview sheet exists, calls the internal `analyze` method,\n     * activates the analysis sheet, and shows a success notification.\n     * @return {void}\n     * @public\n     * @example\n     * // Called from a menu item or controller:\n     * FinancialPlanner.FinancialAnalysisService.showKeyMetrics();\n     */\n    showKeyMetrics: function() {\n      try {\n        const spreadsheet = SpreadsheetApp.getActiveSpreadsheet();\n        const overviewSheet = spreadsheet.getSheetByName(config.getSection('SHEETS').OVERVIEW);\n        \n        if (!overviewSheet) {\n          uiService.showErrorNotification(\"Error\", \n            \"Overview sheet not found. Please generate the financial overview first.\");\n          return;\n        }\n        \n        // Analyze the data by calling the module's analyze function\n        // which correctly instantiates the service\n        FinancialPlanner.FinancialAnalysisService.analyze(spreadsheet, overviewSheet);\n        \n        // Activate the Analysis sheet to show it to the user\n        const analysisSheet = spreadsheet.getSheetByName(config.getSection('SHEETS').ANALYSIS);\n        analysisSheet.activate();\n        \n        uiService.showSuccessNotification(\"Key metrics have been generated in the Analysis sheet.\");\n      } catch (error) {\n        errorService.handle(error, \"Failed to generate key metrics\");\n      }\n    },\n    /**\n     * Public method to trigger the suggestion of savings opportunities.\n     * Ensures the overview sheet exists, runs the analysis, and calls the internal placeholder method.\n     * @return {void}\n     * @public\n     * @example\n     * // Called from a menu item or controller:\n     * FinancialPlanner.FinancialAnalysisService.suggestSavingsOpportunities();\n    "}