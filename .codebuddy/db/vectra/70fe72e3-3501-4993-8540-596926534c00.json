{"chunk":5,"numChunks":20,"fileHash":"o9TH+WxWjuhYMssoSmFWfKxIkklvisnvxWTURfiVSIQ=","filePath":"src/services/monthly_spending_report.js","content":"/**\nFinancialPlanner.MonthlySpendingReport = (function(utils, uiService, errorService, config) {\n  function addMonthlyReportCharts(sheet, categoryData, totalExpenses) {\n    // Find last row with data\n    const lastRow = sheet.getLastRow();\n    \n    // Create pie chart for category breakdown\n    const categories = Object.keys(categoryData);\n    const categoryValues = categories.map(category => {\n      return Object.values(categoryData[category]).reduce((sum, amount) => sum + amount, 0);\n    });\n    \n    // Create temporary range for chart data\n    const chartDataRangeStartRow = lastRow + 3;\n    const numChartDataRows = categories.length + 1; // +1 for header\n    const chartRange = sheet.getRange(chartDataRangeStartRow, 1, numChartDataRows, 2);\n    \n    // Prepare data for batch write\n    const chartData = [[\"Category\", \"Amount\"]]; // Header row\n    for (let i = 0; i < categories.length; i++) {\n      chartData.push([categories[i], categoryValues[i]]);\n    }\n    \n    // Batch write chart data\n    chartRange.setValues(chartData);\n    \n    // Create the chart using the same range\n    const pieChart = sheet.newChart()\n      .setChartType(Charts.ChartType.PIE)\n      .addRange(chartRange)\n      .setPosition(5, 8, 0, 0)\n      .setOption('title', 'Expense Breakdown by Category')\n      .setOption('pieSliceText', 'percentage')\n      .setOption('width', 450)\n      .setOption('height', 300)\n      .build();\n    \n    sheet.insertChart(pieChart);\n  }"}