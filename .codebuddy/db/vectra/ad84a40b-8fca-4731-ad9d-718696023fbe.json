{"chunk":18,"numChunks":53,"fileHash":"sZNtFtlzBgOlJ3052pxcb3tYBWiJBgfxmxjkXMyDhtg=","filePath":"cline/clasp-verify/src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) { // Added settingsService and analysisServiceInstance\n  function addCategoryRows(sheet, combinations, rowIndex, type, columnIndices) {\n    if (combinations.length === 0) return rowIndex;\n    const expenseTypes = config.getSection('EXPENSE_TYPES');\n    const colors = config.getSection('COLORS').UI;\n    const sheetNames = config.getSection('SHEETS');\n    // Batch operation for setting values\n    const startRow = rowIndex;\n    const numRows = combinations.length;\n    // Create arrays for bulk updates\n    const categoryData = Array(numRows).fill().map(() => Array(3).fill(\"\"));\n    // Prepare data for bulk insert\n    combinations.forEach((combo, index) => {\n      categoryData[index][0] = combo.type;\n      categoryData[index][1] = combo.category;\n      categoryData[index][2] = combo.subcategory;\n    });\n    // Set all values at once\n    sheet.getRange(startRow, 1, numRows, 3).setValues(categoryData);\n    // Set checkboxes for Shared column for expense types\n    if (expenseTypes.includes(type)) {\n      sheet.getRange(startRow, 4, numRows, 1).insertCheckboxes();\n    }\n    // Batch prepare all formulas\n    const monthFormulas = [];\n    // For each category combination..."}