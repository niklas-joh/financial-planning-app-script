{"chunk":13,"numChunks":35,"fileHash":"KnGRZfWKIc39Wbh8b5JI+OtSMVtmab0GI6OHguWwGLg=","filePath":"src/features/financial-analysis/financial_analysis.js","content":"/**\nFinancialPlanner.FinancialAnalysisService = (function(\n) {\n  class MetricCardBuilder {\n    createCard(metric, startRow, startColumn) {\n      annualValueCell.setFontSize(18)\n        .setFontColor('#008000')\n        .setHorizontalAlignment('center')\n        .setVerticalAlignment('middle');\n      // Apply number formatting\n      if (metric.valueType === 'currency') {\n        const currencyFormat = this.config.getLocale().NUMBER_FORMATS.CURRENCY_DEFAULT;\n        monthlyValueCell.setNumberFormat(currencyFormat);\n        if (metric.totalFormula) annualValueCell.setNumberFormat(currencyFormat);\n      } else if (metric.valueType === 'percentage') {\n        monthlyValueCell.setNumberFormat('0.00%');\n        if (typeof metric.targetValue === 'number') {\n          annualValueCell.setNumberFormat('0.00%');\n        }\n      }\n      // Sparkline placeholder\n      sheet.getRange(startRow + 2, startColumn, 1, 2).merge()\n        .setValue(metric.sparklinePlaceholderText || `[Sparkline: ${metric.name}]`)\n        .setHorizontalAlignment('center')\n        .setVerticalAlignment('middle')\n        .setFontStyle('italic')\n        .setFontColor('#AAAAAA');\n      // Labels\n      sheet.getRange(startRow + 3, startColumn)\n        .setValue(metric.avgLabel || 'Monthly Avg.')\n        .setFontSize(9)\n        .setFontColor('#808080')\n        .setHorizontalAlignment('center')\n        .setVerticalAlignment('middle');\n      sheet.getRange(startRow + 3, startColumn + 1)\n        .setValue(metric.totalLabel || (metric.targetValue !== undefined ? 'Target' : 'Annual Total'))\n        .setFontSize(9)\n        .setFontColor('#808080')\n        .setHorizontalAlignment('center')\n        .setVerticalAlignment('middle');\n      // Description"}