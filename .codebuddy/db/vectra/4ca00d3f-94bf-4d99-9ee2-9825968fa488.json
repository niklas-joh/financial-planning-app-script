{"chunk":22,"numChunks":36,"fileHash":"5PxeaT4n9kgvALpAj5B1jgQlallPIdU12UlI5e4vOJw=","filePath":"src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) {\n  function addNetCalculations(sheet, startRow) {\n    if (incomeRow && essentialsRow && wantsPleasureRow) {\n      sheet.getRange(startRow, 1).setValue(\"Net (Income - Expenses before Extra)\");\n      sheet.getRange(startRow, 1, 1, 4).setBackground(\"#F5F5F5\").setFontWeight(\"bold\");\n      let formulasArr_new = [];\n      for (let col = 5; col <= 18; col++) {\n        formulasArr_new.push(`=SUM(${utils.columnToLetter(col)}${incomeRow},${utils.columnToLetter(col)}${essentialsRow},${utils.columnToLetter(col)}${wantsPleasureRow})`);\n      }\n      let numericRange_new = sheet.getRange(startRow, 5, 1, 14);\n      numericRange_new.setFormulas([formulasArr_new]).setFontColor(\"#000000\"); formatRangeAsCurrency(numericRange_new, true);\n      startRow++;\n    } else {\n      Logger.log(\"AddNetCalculations: Missing incomeRow, essentialsRow, or wantsPleasureRow for 'Net (Income - Expenses before Extra)'. Skipping this calculation.\");\n    }\n    // Existing Calculation: Net (Total Income - Expenses)\n    sheet.getRange(startRow, 1).setValue(\"Net (Total Income - Expenses)\");\n    sheet.getRange(startRow, 1, 1, 4).setBackground(\"#F5F5F5\").setFontWeight(\"bold\");\n    let formulasArr = [];\n    for (let col = 5; col <= 18; col++) formulasArr.push(`=${utils.columnToLetter(col)}${incomeRow}+${utils.columnToLetter(col)}${expensesRow}`);\n    let numericRange = sheet.getRange(startRow, "}