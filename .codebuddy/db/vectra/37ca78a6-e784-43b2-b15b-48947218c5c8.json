{"chunk":46,"numChunks":54,"fileHash":"vN+W2tDiA59Daq+vJZZ4NvNU8baK6mDpzqFA2kTr3NY=","filePath":"cline/clasp-pull/src/services/financial_analysis.js","content":"/**\nFinancialPlanner.FinancialAnalysisService = (function(utils, uiService, errorService, config) {\n  class FinancialAnalysisService {\n    createExpenditureCharts(startRow) {\n      pieChartBuilder\n        .setChartType(Charts.ChartType.PIE)\n        .addRange(pieDataRange)\n        .setPosition(startRow, 1, 0, 0)\n        .setOption('title', 'Expenditure Breakdown')\n        .setOption('titleTextStyle', {\n          color: this.config.COLORS.CHART.TITLE,\n          fontSize: 16,\n          bold: true\n        })\n        .setOption('pieSliceText', 'percentage')\n        .setOption('pieHole', 0.4) // Create a donut chart for more modern look\n        .setOption('legend', { \n          position: 'right',\n          textStyle: {\n            color: this.config.COLORS.CHART.TEXT,\n            fontSize: 12\n          }\n        })\n        .setOption('colors', this.config.COLORS.CHART.SERIES)\n        .setOption('width', 450)\n        .setOption('height', 300)\n        .setOption('is3D', false)\n        .setOption('pieSliceTextStyle', {\n          color: '#FFFFFF',\n          fontSize: 14,\n          bold: true\n        })\n        .setOption('tooltip', { \n          showColorCode: true,\n          textStyle: { fontSize: 12 }\n        });\n      // Add the pie chart to the sheet\n      this.analysisSheet.insertChart(pieChartBuilder.build());\n      // Create a column chart showing expense categories vs target\n      const columnChartBuilder = this.analysisSheet.newChart();\n      // Define data range for the column chart (category, actual %, target %)\n      const columnDataRange = this.analysisSheet.getRange(categoryStartRow, 1, categoryEndRow - categoryStartRow, "}