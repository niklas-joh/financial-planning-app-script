{"chunk":22,"numChunks":35,"fileHash":"KnGRZfWKIc39Wbh8b5JI+OtSMVtmab0GI6OHguWwGLg=","filePath":"src/features/financial-analysis/financial_analysis.js","content":"/**\nFinancialPlanner.FinancialAnalysisService = (function(\n) {\n  class FinancialAnalysisService {\n    constructor(spreadsheet, overviewSheet) {\n      this.spreadsheet = spreadsheet;\n      this.overviewSheet = overviewSheet;\n      this.analysisSheet = utils.getOrCreateSheet(spreadsheet, config.getSection('SHEETS').ANALYSIS);\n      this.dataExtractor = new DataExtractor(overviewSheet);\n      this.builder = sheetBuilder.create(this.analysisSheet);\n      this.metricsCalculator = metricsCalculator;\n      this.formulaBuilder = formulaBuilder;\n    }\n    analyze() {\n      const metrics = this.dataExtractor.extractMetrics();\n      \n      this.builder\n        .clear()\n        .addHeaderRow(['Financial Analysis'], {\n          merge: 6,\n          background: config.getSection('COLORS').UI.HEADER_BG,\n          fontWeight: 'bold',\n          fontColor: config.getSection('COLORS').UI.HEADER_FONT,\n          horizontalAlignment: 'center'\n        })\n        .freezeRows(1);\n      \n      // Set column widths\n      this.builder.setColumnWidths({\n        1: 20,   // Narrow left margin\n        2: 120,  // Card column\n        3: 120,  // Card column\n        4: 20,   // Spacer\n        5: 120,  // Card column\n        6: 120   // Card column\n      });\n      \n      this.buildKeyMetricsSection(metrics);\n      this.buildExpenseAnalysis(metrics);\n      this.createCharts(metrics);\n      \n      return this.builder.finalize();\n    }"}