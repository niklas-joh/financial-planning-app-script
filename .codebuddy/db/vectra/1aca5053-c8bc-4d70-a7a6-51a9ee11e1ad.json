{"chunk":11,"numChunks":27,"fileHash":"Hvfxbs62+mBjdPYhoaFqbZMl0X/76Hadv8OqiZ+yaKg=","filePath":"cline/clasp-pull/src/services/dropdowns.js","content":"/**\nFinancialPlanner.DropdownService = (function(utils, uiService, errorService, config) {\n  /**\n   * Sets a data validation rule (dropdown list) for a given cell range.\n   * Includes a placeholder text as the first option.\n   * @param {GoogleAppsScript.Spreadsheet.Range} range - The cell range to apply the validation to.\n   * @param {string[]} options - An array of strings representing the dropdown options.\n   * @return {void}\n   * @private\n   */\n  function setDropdownValidation(range, options) {\n    range.clearDataValidations();\n    if (!options || options.length === 0) {\n      return;\n    }\n    const rule = SpreadsheetApp.newDataValidation()\n      .requireValueInList([DROPDOWN_CONFIG.UI.PLACEHOLDER_TEXT, ...options], true)\n      .setAllowInvalid(true) // Allow users to enter values not in the list\n      .build();\n    range.setDataValidation(rule);\n  }\n  /**\n   * Clears the content of a cell if it currently holds the placeholder text.\n   * @param {GoogleAppsScript.Spreadsheet.Range} range - The cell range to check and clear.\n   * @return {void}\n   * @private\n   */\n  function clearPlaceholderIfNeeded(range) {\n    if (range.getValue() === DROPDOWN_CONFIG.UI.PLACEHOLDER_TEXT) {\n      range.clearContent();\n    }\n  }"}