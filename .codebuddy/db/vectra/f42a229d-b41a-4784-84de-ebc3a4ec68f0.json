{"chunk":7,"numChunks":36,"fileHash":"5PxeaT4n9kgvALpAj5B1jgQlallPIdU12UlI5e4vOJw=","filePath":"src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) {\n  function buildMonthlySumFormula(params, overviewSheetCurrentRow) {\n    const { \n      monthDate, \n      sheetName, // Name of the Transactions sheet\n      typeCol, categoryCol, subcategoryCol, dateCol, amountCol, // Column indices for Transactions sheet\n      overviewSheetName, // Name of the Overview sheet\n      showSubCategories // Boolean: whether subcategories are currently shown/relevant\n    } = params;\n    const month = monthDate.getMonth() + 1;\n    const year = monthDate.getFullYear();\n    const startDate = new Date(year, month - 1, 1);\n    const endDate = new Date(year, month, 0);\n    const startDateFormatted = formatDate(startDate);\n    const endDateFormatted = formatDate(endDate);\n    const sumRange = `${sheetName}!${utils.columnToLetter(amountCol)}:${utils.columnToLetter(amountCol)}`;\n    // Base criteria: Always filter by Type (referencing Overview sheet Col A) and Date Range\n    const baseCriteria = [\n      `${sheetName}!${utils.columnToLetter(typeCol)}:${utils.columnToLetter(typeCol)},${overviewSheetName}!$A${overviewSheetCurrentRow}`,\n      `${sheetName}!${utils.columnToLetter(dateCol)}:${utils.columnToLetter(dateCol)},\">=${startDateFormatted}\"`,\n      `${sheetName}!${utils.columnToLetter(dateCol)}:${utils.columnToLetter(dateCol)},\"<=${endDateFormatted}\"`\n    ];\n    // Conditionally add Category criteria (referencing Overview sheet Col B)\n    // params.category will contain the actual category name if this row is for a specific category"}