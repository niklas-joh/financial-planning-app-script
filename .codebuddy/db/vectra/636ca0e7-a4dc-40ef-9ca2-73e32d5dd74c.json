{"chunk":29,"numChunks":30,"fileHash":"+K7Wn3694Zo7CvqWeZ2iy4UDcUumZZ0a1vWhvg0ddkM=","filePath":"src/tests/financial_analysis.test.js","content":"/**\n(function() {\n  T.registerTest(\"FinancialAnalysisService\", \"showKeyMetrics should call analyze and activate sheet\", function() {\n      setupMockDataAndState();\n\n      TestAnalysisService.showKeyMetrics();\n\n      T.assertNotNull(mockActiveSpreadsheet.getSheetByName(\"Analysis\"), \"Analysis sheet should exist after showKeyMetrics.\");\n      T.assertEquals(\"Analysis\", activeSheetName, \"Analysis sheet should be activated.\");\n      T.assertNotNull(lastToast, \"Success notification should be shown.\");\n      T.assertEquals(\"Key metrics have been generated in the Analysis sheet.\", lastToast.message, \"Correct success message expected.\");\n      T.assertTrue(lastHandledError === null, \"No error should be handled during successful showKeyMetrics.\");\n  });\n  T.registerTest(\"FinancialAnalysisService\", \"showKeyMetrics should show error if Overview sheet missing\", function() {\n      setupMockDataAndState();\n      delete mockActiveSpreadsheet.sheets[\"Overview\"]; // Remove overview sheet\n\n      TestAnalysisService.showKeyMetrics();\n\n      T.assertNotNull(lastAlert, \"Error notification (alert) should be shown.\");\n      T.assertTrue(lastAlert.message.includes(\"Overview sheet not found\"), \"Error message should indicate missing Overview sheet.\");\n      T.assertTrue(activeSheetName !== \"Analysis\", \"Analysis sheet should not be activated on error.\");\n  });"}