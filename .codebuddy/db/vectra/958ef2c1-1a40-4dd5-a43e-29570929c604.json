{"chunk":41,"numChunks":53,"fileHash":"sZNtFtlzBgOlJ3052pxcb3tYBWiJBgfxmxjkXMyDhtg=","filePath":"cline/clasp-pull/src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) { // Added settingsService and analysisServiceInstance\n  class FinancialOverviewBuilder {\n    /**\n     * Processes the transaction data by retrieving it, identifying column indices,\n     * extracting unique category combinations (using cache), and grouping them by type (using cache).\n     * Stores the processed data and combinations within the builder instance.\n     * @return {FinancialOverviewBuilder} Returns the builder instance for method chaining.\n     */\n    processData() {\n      // Get and process transaction data\n      const { data, indices } = getProcessedTransactionData(this.transactionSheet);\n      this.transactionData = data;\n      this.columnIndices = indices;\n      \n      // Get category combinations with caching\n      this.categoryCombinations = cacheService.get(\n        config.getSection('CACHE').KEYS.CATEGORY_COMBINATIONS,\n        () => getUniqueCategoryCombinations(\n          this.transactionData, \n          this.columnIndices.type, \n          this.columnIndices.category, \n          this.columnIndices.subcategory, \n          this.showSubCategories\n        )\n      );\n      \n      // Group categories by type\n      this.groupedCombinations = cacheService.get(\n        config.getSection('CACHE').KEYS.GROUPED_COMBINATIONS,\n        () => groupCategoryCombinations(this.categoryCombinations)\n      );\n      \n      return this;\n    }\n    /**\n     * Sets up the header row on the overview sheet using the `setupHeaderRow` helper function.\n     * @return {FinancialOverviewBuilder} Returns the builder instance for method chaining.\n     */\n    setupHeader() {\n      setupHeaderRow(this.overviewSheet, this.showSubCategories);\n      return this;\n    }\n    /**\n     * Generates the main body of the overview sheet.\n     * Iterates through transaction types in the configured order, adding type headers,\n     * category/sub-category rows with formulas, and type sub"}