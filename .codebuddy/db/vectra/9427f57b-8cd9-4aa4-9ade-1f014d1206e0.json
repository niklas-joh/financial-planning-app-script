{"chunk":12,"numChunks":35,"fileHash":"KnGRZfWKIc39Wbh8b5JI+OtSMVtmab0GI6OHguWwGLg=","filePath":"src/features/financial-analysis/financial_analysis.js","content":"/**\nFinancialPlanner.FinancialAnalysisService = (function(\n) {\n  class MetricCardBuilder {\n    createCard(metric, startRow, startColumn) {\n      const sheet = this.builder.sheet;\n      // Set row heights for card structure\n      sheet.setRowHeight(startRow, 25);      // Header\n      sheet.setRowHeight(startRow + 1, 35);  // Values\n      sheet.setRowHeight(startRow + 2, 30);  // Sparkline\n      sheet.setRowHeight(startRow + 3, 20);  // Labels\n      sheet.setRowHeight(startRow + 4, 35);  // Description\n      // Header\n      sheet.getRange(startRow, startColumn, 1, 2).merge()\n        .setValue(metric.name)\n        .setBackground('#E2EFDA')\n        .setFontWeight('bold')\n        .setFontColor('black')\n        .setHorizontalAlignment('center')\n        .setVerticalAlignment('middle');\n      // Monthly value\n      const monthlyValueCell = sheet.getRange(startRow + 1, startColumn);\n      monthlyValueCell.setFormula(metric.avgFormula)\n        .setFontSize(18)\n        .setFontColor('#008000')\n        .setHorizontalAlignment('center')\n        .setVerticalAlignment('middle');\n      // Annual/Target value\n      const annualValueCell = sheet.getRange(startRow + 1, startColumn + 1);\n      if (metric.totalFormula) {\n        annualValueCell.setFormula(metric.totalFormula);\n      } else if (metric.targetValue !== undefined) {\n        annualValueCell.setValue(metric.targetValue);\n      }"}