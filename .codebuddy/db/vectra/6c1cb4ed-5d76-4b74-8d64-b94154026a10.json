{"chunk":28,"numChunks":36,"fileHash":"5PxeaT4n9kgvALpAj5B1jgQlallPIdU12UlI5e4vOJw=","filePath":"src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) {\n  function formatOverviewSheet(sheet) {\n    const headers = config.getSection('HEADERS'); const uiConfig = config.getSection('UI').COLUMN_WIDTHS;\n    const colors = config.getSection('COLORS').UI;\n    sheet.setColumnWidth(1, uiConfig.TYPE); sheet.setColumnWidth(2, uiConfig.CATEGORY);\n    sheet.setColumnWidth(3, uiConfig.SUBCATEGORY); sheet.setColumnWidth(4, uiConfig.SHARED);\n    for (let i = 5; i <= 16; i++) sheet.setColumnWidth(i, uiConfig.MONTH);\n    sheet.setColumnWidth(17, uiConfig.AVERAGE); sheet.setColumnWidth(18, uiConfig.AVERAGE); \n    const data = sheet.getDataRange().getValues();\n    for (let i = 0; i < data.length; i++) {\n      if (data[i][0] && (data[i][0].toString().startsWith(\"Total \") || data[i][0] === config.getSection('TRANSACTION_TYPES').SAVINGS)) { // Include \"Savings\" row for border\n        sheet.getRange(i + 1, 1, 1, headers.length).setBorder(null, null, true, null, null, null, colors.BORDER, SpreadsheetApp.BorderStyle.SOLID_MEDIUM);\n      }\n    }\n  }\n  function getTypeColors(type) {\n    const typeHeaders = config.getSection('COLORS').TYPE_HEADERS;\n    const transactionTypes = config.getSection('TRANSACTION_TYPES');\n    let colors = typeHeaders.DEFAULT; const normalizedType = type.toLowerCase();\n    for (const key in transactionTypes) {\n      if (transactionTypes[key].toLowerCase() === normalizedType && typeHeaders[key]) { colors = typeHeaders[key]; break; }\n    }\n    if (normalizedType === \"wants/pleasure"}