{"chunk":20,"numChunks":32,"fileHash":"EGim/Ynj/8ex+ANaWj1uKBWsGdoONzQU8Kj/M33Ydzo=","filePath":"cline/clasp-pull/src/tests/monthly_spending_report.test.js","content":"/**\n(function() {\n   const TestMonthlySpendingReport = (function(utils, uiService, errorService, config) {\n       // --- Copy of MonthlySpendingReport Implementation Start ---\n        function addMonthlyReportCharts(sheet, categoryData, totalExpenses) { const lastRow = sheet.getLastRow(); const categories = Object.keys(categoryData); const categoryValues = categories.map(category => { return Object.values(categoryData[category]).reduce((sum, amount) => sum + amount, 0); }); const chartRange = sheet.getRange(lastRow + 3, 1, categories.length + 1, 2); sheet.getRange(lastRow + 3, 1).setValue(\"Category\"); sheet.getRange(lastRow + 3, 2).setValue(\"Amount\"); for (let i = 0; i < categories.length; i++) { sheet.getRange(lastRow + 4 + i, 1).setValue(categories[i]); sheet.getRange(lastRow + 4 + i, 2).setValue(categoryValues[i]); } const pieChart = sheet.newChart().setChartType(Charts.ChartType.PIE).addRange(chartRange).setPosition(5, 8, 0, 0).setOption('title', 'Expense Breakdown by Category').setOption('pieSliceText', 'percentage').setOption('width', 450).setOption('height', 300).build(); sheet.insertChart(pieChart); }"}