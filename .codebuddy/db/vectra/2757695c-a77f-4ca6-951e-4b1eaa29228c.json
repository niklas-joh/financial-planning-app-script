{"chunk":21,"numChunks":23,"fileHash":"CQfg6CTbjaSJNNQcldTeFCWrygm/GYuNhHS4k156290=","filePath":"src/core/controllers.js","content":"/**\nfunction createGlobalControllerAction(methodName) {\n  // eslint-disable-next-line no-unused-vars\n  this[methodName + '_Global'] = function(...args) { // Use 'this' to attach to global scope in Apps Script\n    if (FinancialPlanner && FinancialPlanner.Controllers && typeof FinancialPlanner.Controllers[methodName + '_Wrapped'] === 'function') {\n      try {\n        return FinancialPlanner.Controllers[methodName + '_Wrapped'](...args);\n      } catch (e) {\n        // Error already handled by _wrapWithFeedback, but good to log it happened at global call level too.\n        // FinancialPlanner.ErrorService might not be available here if Controllers itself failed to init.\n        console.error(`Error during global call to ${methodName}_Wrapped: ${e.message}`);\n        // Optionally, show a generic UI error if possible and not redundant\n        // SpreadsheetApp.getUi().alert(\"An unexpected error occurred. Please check logs.\");\n      }\n    } else {\n      const msg = `Controller action ${methodName}_Wrapped not available.`;\n      console.error(msg);\n      if (FinancialPlanner && FinancialPlanner.Controllers && FinancialPlanner.Controllers.uiService) {\n         FinancialPlanner.Controllers.uiService.showErrorNotification('Error', msg);\n      } else {\n        SpreadsheetApp.getUi().alert(msg);\n      }\n    }\n  };\n}\n// Create global functions for all wrapped controller actions\n// These names must match what's used in the onOpen menu creation.\ncreateGlobalControllerAction('createFinancialOverview');\ncreateGlobalControllerAction('generateMonthlySpendingReport');\ncreateGlobalControllerAction('showKeyMetrics');\ncreateGlobalControllerAction('generateYearlySummary');\ncreateGlobalControllerAction('generateCategoryBreakdown');\ncreateGlobalControllerAction('generateSavingsAnalysis');\ncreateGlobalControllerAction('createSpendingTrendsChart');\ncreateGlobalControllerAction('createBudgetVsActualChart');\ncreateGlobalControllerAction('createIncomeVsExpensesChart');\ncreateGlobalControllerAction('createCategory"}