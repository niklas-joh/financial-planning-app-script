{"chunk":6,"numChunks":25,"fileHash":"f+DVHertk8Vofto68USweVqQ1XJB474SC9cN3OV7d2s=","filePath":"src/features/financial-overview/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(\n) {\n  class FinancialOverviewBuilder {\n    constructor() {\n      this.spreadsheet = SpreadsheetApp.getActiveSpreadsheet();\n      this.showSubCategories = settingsService.getShowSubCategories();\n      this.builder = null;\n      this.processor = null;\n      this.groupedData = null;\n      this.columnIndices = null;\n    }\n    initialize() {\n      const sheetNames = config.getSection('SHEETS');\n      const overviewSheet = utils.getOrCreateSheet(this.spreadsheet, sheetNames.OVERVIEW);\n      this.builder = sheetBuilder.create(overviewSheet);\n      \n      const transactionSheet = this.spreadsheet.getSheetByName(sheetNames.TRANSACTIONS);\n      if (!transactionSheet) {\n        throw errorService.create(`Required sheet \"${sheetNames.TRANSACTIONS}\" not found`, { \n          severity: \"high\" \n        });\n      }\n      \n      const transactionData = transactionSheet.getDataRange().getValues();\n      this.columnIndices = dataProcessor.getColumnIndices(transactionData[0]);\n      this.processor = dataProcessor.create(transactionData, this.columnIndices);\n      \n      // Validate data structure\n      this.processor.validateStructure();\n      \n      // Get cached or process data\n      const combinations = cacheService.get('finance_overview_categories', \n        () => this.processor.getUniqueCombinations(this.showSubCategories)\n      );\n      \n      this.groupedData = cacheService.get('finance_overview_grouped',\n        () => this.processor.groupByType(combinations)\n      );\n      \n      return this;\n    }"}