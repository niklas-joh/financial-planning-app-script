{"chunk":29,"numChunks":53,"fileHash":"sZNtFtlzBgOlJ3052pxcb3tYBWiJBgfxmxjkXMyDhtg=","filePath":"cline/clasp-pull/src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) { // Added settingsService and analysisServiceInstance\n  function addNetCalculations(sheet, startRow) {\n    if (savingsRow) {\n      // Add Total Expenses + Savings row\n      sheet.getRange(startRow, 1).setValue(\"Total Expenses + Savings\");\n      sheet.getRange(startRow, 1, 1, 4).setBackground(\"#F5F5F5\").setFontWeight(\"bold\");\n      \n      // Create formulas\n      const expSavFormulas = [];\n      for (let col = 5; col <= 17; col++) {\n        expSavFormulas.push(`=${utils.columnToLetter(col)}${expensesRow}+${utils.columnToLetter(col)}${savingsRow}`);\n      }\n      \n      // Apply formulas in batch\n      sheet.getRange(startRow, 5, 1, 13).setFormulas([expSavFormulas]);\n      formatRangeAsCurrency(sheet.getRange(startRow, 5, 1, 13));\n      \n      startRow++;\n      \n      // Add Net (Income - Expenses - Savings) row\n      sheet.getRange(startRow, 1).setValue(\"Net (Total Income - Expenses - Savings)\");\n      sheet.getRange(startRow, 1, 1, 4).setBackground(\"#F5F5F5\").setFontWeight(\"bold\");\n      \n      // Create formulas\n      const totalNetFormulas = [];\n      for (let col = 5; col <= 17; col++) {\n        totalNetFormulas.push(`=${utils.columnToLetter(col)}${incomeRow}-${utils.columnToLetter(col)}${expensesRow}-${utils.columnToLetter(col)}${savingsRow}`);\n      }\n      \n      // Apply formulas in batch\n      sheet.getRange(startRow, 5, 1, "}