{"chunk":19,"numChunks":36,"fileHash":"5PxeaT4n9kgvALpAj5B1jgQlallPIdU12UlI5e4vOJw=","filePath":"src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) {\n  function addTypeSubtotalRow(sheet, type, rowIndex, rowCount) { // Used for Income total\n    const typeColors = getTypeColors(type); const headers = config.getSection('HEADERS');\n    sheet.getRange(rowIndex, 1).setValue(`Total ${type}`);\n    const subtotalRowRange = sheet.getRange(rowIndex, 1, 1, headers.length);\n    subtotalRowRange.setBackground(typeColors.BG).setFontWeight(\"bold\").setFontColor(typeColors.FONT);\n    const formulas = []; const startRowForSum = rowIndex - rowCount; const endRowForSum = rowIndex - 1;\n    for (let monthCol = 5; monthCol <= 18; monthCol++) formulas.push(`=SUM(${utils.columnToLetter(monthCol)}${startRowForSum}:${utils.columnToLetter(monthCol)}${endRowForSum})`);\n    const formulaRange = sheet.getRange(rowIndex, 5, 1, 14); \n    formulaRange.setFormulas([formulas]).setFontColor(typeColors.FONT);\n    formatRangeAsCurrency(formulaRange, true); \n    return rowIndex + 1;\n  }"}