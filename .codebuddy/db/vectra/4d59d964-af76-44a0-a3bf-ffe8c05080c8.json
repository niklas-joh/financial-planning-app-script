{"chunk":11,"numChunks":12,"fileHash":"JN8zrR3RLBMehoajMVV4kRdQBPjVa7ydJZnM5WDgr0E=","filePath":"src/services/formula-builder.js","content":"/**\nconst FormulaBuilderModule = (function() {\n  FormulaBuilderModuleConstructor.prototype.buildCategoryTotalFormula = function(params) {\n    const {\n      transactionSheet,\n      amountColumn,\n      typeColumn,\n      categoryColumn,\n      subcategoryColumn,\n      dateColumn,\n      typeValue,\n      categoryValue,\n      subcategoryValue,\n      monthDate,\n      overviewSheetName,\n      currentRow,\n      showSubCategories\n    } = params;\n    const month = monthDate.getMonth() + 1;\n    const year = monthDate.getFullYear();\n    const startDate = new Date(year, month - 1, 1);\n    const endDate = new Date(year, month, 0);\n    const criteria = [\n      { range: `${transactionSheet}!${typeColumn}:${typeColumn}`, \n        value: `${overviewSheetName}!$A${currentRow}` },\n      { range: `${transactionSheet}!${dateColumn}:${dateColumn}`, \n        operator: '>=', \n        value: Utilities.formatDate(startDate, Session.getScriptTimeZone(), this.config.getSection('LOCALE').DATE_FORMAT), \n        type: 'date' },\n      { range: `${transactionSheet}!${dateColumn}:${dateColumn}`, \n        operator: '<=', \n        value: Utilities.formatDate(endDate, Session.getScriptTimeZone(), this.config.getSection('LOCALE').DATE_FORMAT), \n        type: 'date' }\n    ];\n    if (categoryValue) {\n      criteria.push({ \n        range: `${transactionSheet}!${categoryColumn}:${categoryColumn}`, \n        value: `${overviewSheetName}!$B${currentRow}` \n      });\n      \n      if (subcategoryValue && showSubCategories) {\n        criteria.push({ \n          range: `${transactionSheet}!${subcategoryColumn}:${subcategoryColumn}`, \n          value: `${overviewSheetName}!$C${currentRow}` \n        });\n      }\n    }"}