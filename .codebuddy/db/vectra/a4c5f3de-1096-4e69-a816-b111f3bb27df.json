{"chunk":18,"numChunks":36,"fileHash":"5PxeaT4n9kgvALpAj5B1jgQlallPIdU12UlI5e4vOJw=","filePath":"src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) {\n  function addOverallExpensesTotalRow(sheet, rowIndex, expenseTypeTotalRowIndices) {\n    const headers = config.getSection('HEADERS');\n    const uiColors = config.getSection('COLORS').UI;\n    const style = { backgroundColor: uiColors.GRAND_TOTAL_BG || \"#bfbfbf\", fontColor: uiColors.GRAND_TOTAL_FONT || \"#000000\", fontWeight: \"bold\", fontSize: 11 };\n    sheet.getRange(rowIndex, 1).setValue(\"Total Expenses\");\n    const rowRange = sheet.getRange(rowIndex, 1, 1, headers.length);\n    rowRange.setBackground(style.backgroundColor).setFontWeight(style.fontWeight).setFontColor(style.fontColor).setFontSize(style.fontSize).setVerticalAlignment(\"middle\");\n    const formulas = [];\n    if (expenseTypeTotalRowIndices.length === 0) for (let i = 0; i < 14; i++) formulas.push(0);\n    else for (let monthCol = 5; monthCol <= 18; monthCol++) {\n      const colLetter = utils.columnToLetter(monthCol);\n      const sumParts = expenseTypeTotalRowIndices.map(rn => `${colLetter}${rn}`);\n      formulas.push(`=SUM(${sumParts.join(\",\")})`);\n    }\n    const formulaRange = sheet.getRange(rowIndex, 5, 1, 14);\n    formulaRange.setFormulas([formulas]).setFontColor(style.fontColor);\n    formatRangeAsCurrency(formulaRange, true);\n    return rowIndex + 1;\n  }"}