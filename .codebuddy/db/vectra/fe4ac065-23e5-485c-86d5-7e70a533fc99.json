{"chunk":14,"numChunks":53,"fileHash":"sZNtFtlzBgOlJ3052pxcb3tYBWiJBgfxmxjkXMyDhtg=","filePath":"cline/clasp-pull/src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) { // Added settingsService and analysisServiceInstance\n  function setupHeaderRow(sheet, showSubCategories) {\n    const headers = config.getSection('HEADERS');\n    const uiConfig = config.getSection('UI');\n    const colors = config.getSection('COLORS').UI;\n    \n    // Set header values (using batch operation)\n    sheet.getRange(1, 1, 1, headers.length)\n      .setValues([headers]);\n    \n    // Format header row\n    sheet.getRange(1, 1, 1, headers.length)\n      .setBackground(colors.HEADER_BG)\n      .setFontWeight(\"bold\")\n      .setFontColor(colors.HEADER_FONT)\n      .setHorizontalAlignment(\"center\")\n      .setVerticalAlignment(\"middle\");\n    \n    // Add the sub-category toggle\n    const { SUBCATEGORY_TOGGLE } = uiConfig;\n    sheet.getRange(SUBCATEGORY_TOGGLE.LABEL_CELL)\n      .setValue(SUBCATEGORY_TOGGLE.LABEL_TEXT)\n      .setFontWeight(\"bold\");\n    \n    // Add the checkbox\n    const checkbox = sheet.getRange(SUBCATEGORY_TOGGLE.CHECKBOX_CELL);\n    checkbox.insertCheckboxes();\n    checkbox.setValue(showSubCategories);\n    checkbox.setNote(SUBCATEGORY_TOGGLE.NOTE_TEXT);\n    \n    // Freeze the header row\n    sheet.setFrozenRows(1);\n    \n    // Set column width for the Shared? column\n    sheet.setColumnWidth(4, uiConfig.COLUMN_WIDTHS.SHARED);\n  }\n  /**\n   * Adds a styled header row for a specific transaction type (e.g., \"Income\", \"Essentials\") to the overview sheet.\n   * @param {GoogleAppsScript.Spreadsheet.Sheet} sheet - The overview sheet object.\n   * @param {string} type - The name of the transaction type.\n   * @param {number}"}