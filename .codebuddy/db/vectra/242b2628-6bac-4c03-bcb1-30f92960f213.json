{"chunk":43,"numChunks":53,"fileHash":"sZNtFtlzBgOlJ3052pxcb3tYBWiJBgfxmxjkXMyDhtg=","filePath":"cline/clasp-pull/src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) { // Added settingsService and analysisServiceInstance\n  class FinancialOverviewBuilder {\n    generateContent() {\n      let rowIndex = 2; // Start after header\n      \n      // Process each type in the defined order\n      config.getSection('TYPE_ORDER').forEach(type => {\n        // Skip if this type doesn't exist in the data\n        if (!this.groupedCombinations[type]) return;\n        \n        // Add type header row\n        rowIndex = addTypeHeaderRow(this.overviewSheet, type, rowIndex);\n        \n        // Add rows for each category/subcategory in this type\n        rowIndex = addCategoryRows(\n          this.overviewSheet, \n          this.groupedCombinations[type], \n          rowIndex, \n          type, \n          this.columnIndices\n        );\n        \n        // Add subtotal for this type\n        rowIndex = addTypeSubtotalRow(\n          this.overviewSheet, \n          type, \n          rowIndex, \n          this.groupedCombinations[type].length\n        );\n        \n        rowIndex += 2; // Add space between categories\n      });\n      \n      this.lastContentRowIndex = rowIndex;\n      return this;\n    }\n    /**\n     * Adds the 'Net Calculations' section to the overview sheet using the `addNetCalculations` helper function.\n     * @return {FinancialOverviewBuilder} Returns the builder instance for method chaining.\n     */\n    addNetCalculations() {\n      this.lastContentRowIndex = addNetCalculations(\n        this.overviewSheet, \n        this.lastContentRowIndex\n      );\n      return this;\n    }\n    /**\n     * Adds the financial metrics section to the overview sheet by calling the `analyze` method\n     * of the injected `FinancialAnalysisService`. Logs an error if the service is unavailable.\n     * @return {FinancialOverviewBuilder} Returns the builder instance for"}