{"chunk":33,"numChunks":53,"fileHash":"sZNtFtlzBgOlJ3052pxcb3tYBWiJBgfxmxjkXMyDhtg=","filePath":"cline/clasp-pull/src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) { // Added settingsService and analysisServiceInstance\n  function formatOverviewSheet(sheet) {\n    const lastRow = sheet.getLastRow();\n    const headers = config.getSection('HEADERS');\n    const uiConfig = config.getSection('UI').COLUMN_WIDTHS;\n    const colors = config.getSection('COLORS').UI;\n    \n    // Set column widths\n    sheet.setColumnWidth(1, uiConfig.TYPE);\n    sheet.setColumnWidth(2, uiConfig.CATEGORY);\n    sheet.setColumnWidth(3, uiConfig.SUBCATEGORY);\n    sheet.setColumnWidth(4, uiConfig.SHARED);\n    \n    // Set month column widths\n    for (let i = 5; i <= 16; i++) {\n      sheet.setColumnWidth(i, uiConfig.MONTH);\n    }\n    \n    // Set Total and Average column widths\n    sheet.setColumnWidth(17, uiConfig.AVERAGE); // Total column\n    sheet.setColumnWidth(18, uiConfig.AVERAGE); // Average column\n    \n    // Set metrics section column widths\n    sheet.setColumnWidth(10, uiConfig.EXPENSE_CATEGORY);\n    sheet.setColumnWidth(11, uiConfig.AMOUNT);\n    sheet.setColumnWidth(12, uiConfig.RATE);\n    sheet.setColumnWidth(13, uiConfig.RATE);\n    sheet.setColumnWidth(14, uiConfig.RATE);\n    sheet.setColumnWidth(15, uiConfig.AMOUNT);\n    \n    // Add gridlines and borders to improve readability\n    const data = sheet.getDataRange().getValues();\n    \n    // Add bottom borders to total rows\n    for (let i = 0; i < data.length; i++) {\n      if (data[i][0] && data[i][0].startsWith(\"Total \")) {\n        sheet.getRange(i + 1, 1, 1, headers.length).set"}