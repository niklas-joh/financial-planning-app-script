{"chunk":28,"numChunks":54,"fileHash":"vN+W2tDiA59Daq+vJZZ4NvNU8baK6mDpzqFA2kTr3NY=","filePath":"cline/clasp-verify/src/services/financial_analysis.js","content":"/**\nFinancialPlanner.FinancialAnalysisService = (function(utils, uiService, errorService, config) {\n  class FinancialAnalysisService {\n    addKeyMetricsSection(startRow) {\n      if (this.totals.income.row > 0 && this.totals.expenses.row > 0) {\n        metricValues.push([\"Monthly Net Cash Flow\"]);\n        metricFormulas.push([`=${this.totals.income.value}-${this.totals.expenses.value}`]);\n        metricTargets.push([0]); // Target is positive cash flow\n        metricDescriptions.push([\"Positive value means you're earning more than spending, negative means you're spending more than earning\"]);\n        metricBackgrounds.push([metricBgColor]);\n        \n        // Add conditional formatting (green if positive, red if negative)\n        const valueCell = this.analysisSheet.getRange(startRow + currentMetricRow, 2);\n        \n        conditionalFormatRules.push({\n          row: startRow + currentMetricRow,\n          rule: SpreadsheetApp.newConditionalFormatRule()\n            .whenFormulaSatisfied(`B${startRow + currentMetricRow}<0`)\n            .setBackground(\"#FFCDD2\") // Light red if negative\n            .setRanges([valueCell])\n        });\n        \n        currentMetricRow++;\n      }\n      // Write all data to the sheet in batches if we have metrics"}