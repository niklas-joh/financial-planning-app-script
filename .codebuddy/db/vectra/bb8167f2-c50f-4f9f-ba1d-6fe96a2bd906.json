{"chunk":17,"numChunks":25,"fileHash":"f+DVHertk8Vofto68USweVqQ1XJB474SC9cN3OV7d2s=","filePath":"src/features/financial-overview/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(\n) {\n  class FinancialOverviewBuilder {\n    generateRowFormulas(combinations, startRow) {\n      const sheetNames = config.getSection('SHEETS');\n      const formulas = [];\n      // Monthly formulas\n      for (let monthCol = 5; monthCol <= 16; monthCol++) {\n        const monthFormulas = [];\n        for (let i = 0; i < combinations.length; i++) {\n          const combo = combinations[i];\n          const currentRow = startRow + i;\n          const monthDate = new Date(2024, monthCol - 5, 1);\n          \n          const formula = formulaBuilder.buildCategoryTotalFormula({\n            transactionSheet: sheetNames.TRANSACTIONS,\n            amountColumn: utils.columnToLetter(this.columnIndices.amount + 1),\n            typeColumn: utils.columnToLetter(this.columnIndices.type + 1),\n            categoryColumn: utils.columnToLetter(this.columnIndices.category + 1),\n            subcategoryColumn: utils.columnToLetter(this.columnIndices.subcategory + 1),\n            dateColumn: utils.columnToLetter(this.columnIndices.date + 1),\n            typeValue: combo.type,\n            categoryValue: combo.category,\n            subcategoryValue: combo.subcategory,\n            monthDate: monthDate,\n            overviewSheetName: sheetNames.OVERVIEW,\n            currentRow: currentRow,\n            showSubCategories: this.showSubCategories\n          });\n          \n          // Add shared divisor for expense types\n          const expenseTypes = config.getSection('EXPENSE_TYPES');\n          if (expenseTypes.includes(combo.type)) {\n            monthFormulas.push(`(${formula})/IF(D${currentRow}=TRUE, 2, 1)`);\n          } else {\n            monthFormulas.push(formula);\n          }\n        }\n        formulas.push({\n          startColumn: monthCol,\n          values: monthFormulas.map(f => [f])\n        });\n     "}