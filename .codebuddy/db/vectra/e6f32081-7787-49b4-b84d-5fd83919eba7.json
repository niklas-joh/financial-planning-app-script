{"chunk":39,"numChunks":53,"fileHash":"sZNtFtlzBgOlJ3052pxcb3tYBWiJBgfxmxjkXMyDhtg=","filePath":"cline/clasp-pull/src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) { // Added settingsService and analysisServiceInstance\n  class FinancialOverviewBuilder {\n    /**\n     * Initializes the builder's state variables.\n     */\n    constructor() {\n      this.spreadsheet = null;\n      this.overviewSheet = null;\n      this.transactionSheet = null;\n      this.showSubCategories = true;\n      this.transactionData = null;\n      this.columnIndices = null;\n      this.categoryCombinations = null;\n      this.groupedCombinations = null;\n      this.lastContentRowIndex = 0;\n    }\n    /**\n     * Initializes the builder by getting references to the active spreadsheet,\n     * the overview sheet (creating and clearing it if necessary), and the transaction sheet.\n     * Also retrieves the user preference for showing sub-categories.\n     * @return {FinancialOverviewBuilder} Returns the builder instance for method chaining.\n     * @throws {FinancialPlannerError} If the required 'Transactions' sheet is not found.\n     */\n    initialize() {\n      this.spreadsheet = SpreadsheetApp.getActiveSpreadsheet();\n      const sheetNames = config.getSection('SHEETS');\n      \n      // Get or create the Overview sheet and clear it\n      this.overviewSheet = utils.getOrCreateSheet(\n        this.spreadsheet, \n        sheetNames.OVERVIEW\n      );\n      clearSheetContent(this.overviewSheet);\n      \n      // Get transaction sheet\n      this.transactionSheet = this.spreadsheet.getSheetByName(\n        sheetNames.TRANSACTIONS\n      );\n      \n      if (!this.transactionSheet) {\n        throw errorService.create(\n          `Required sheet \"${sheetNames.TRANSACTIONS}\" not found`,\n          { severity: \"high\" }\n        );\n      }\n      \n      // Get user preference for showing sub-categories\n      this.showSubCategories = getUserPreference(\"ShowSubCategories\", true);\n      \n      return this;\n"}