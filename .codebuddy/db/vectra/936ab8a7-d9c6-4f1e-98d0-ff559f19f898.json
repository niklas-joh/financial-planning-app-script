{"chunk":21,"numChunks":36,"fileHash":"5PxeaT4n9kgvALpAj5B1jgQlallPIdU12UlI5e4vOJw=","filePath":"src/services/finance_overview.js","content":"/**\nFinancialPlanner.FinanceOverview = (function(utils, uiService, cacheService, errorService, config, settingsService, analysisServiceInstance) {\n  function addNetCalculations(sheet, startRow) {\n    const data = sheet.getDataRange().getValues(); const headers = config.getSection('HEADERS');\n    const uiColors = config.getSection('COLORS').UI; const totals = findTotalRows(data);\n    // Destructure all needed row numbers, including new ones for Essentials and Wants/Pleasure\n    const { incomeRow, expensesRow, savingsRow, essentialsRow, wantsPleasureRow } = totals; \n    // Check if all required rows for calculations are found\n    if (!incomeRow || !expensesRow) { // Basic check, expensesRow might not be needed for the new first calc but good to keep\n      Logger.log(\"AddNetCalculations: Missing incomeRow or expensesRow. Aborting net calculations.\");\n      return startRow;\n    }\n    sheet.getRange(startRow, 1).setValue(\"Net Calculations\");\n    sheet.getRange(startRow, 1, 1, headers.length).setBackground(uiColors.NET_BG).setFontWeight(\"bold\").setFontColor(uiColors.NET_FONT);\n    startRow++;\n    // New Calculation: Net (Income - Expenses before Extra)\n    // This is Total Income + Essentials + Wants/Pleasure (since expenses are negative)"}